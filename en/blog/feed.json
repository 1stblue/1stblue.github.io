{
    "version": "https://jsonfeed.org/version/1",
    "title": "1stblue.com Blog",
    "home_page_url": "https://1stblue.github.io/en/blog",
    "description": "1stblue.com Blog",
    "items": [
        {
            "id": "https://1stblue.github.io/en/blog/oracle-split-read",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"测试环境\">测试环境<a href=\"#测试环境\" class=\"hash-link\" aria-label=\"Direct link to 测试环境\" title=\"Direct link to 测试环境\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"硬件\">硬件<a href=\"#硬件\" class=\"hash-link\" aria-label=\"Direct link to 硬件\" title=\"Direct link to 硬件\">​</a></h3><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"数据\">数据<a href=\"#数据\" class=\"hash-link\" aria-label=\"Direct link to 数据\" title=\"Direct link to 数据\">​</a></h3><p><strong>表结构</strong></p><div class=\"language-oraclesqlplus rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"py-3 px-4 text-[13px] leading-5 text-gray-600 dark:text-gray-300 border-b dark:border-b-gray-700 font-mono flex items-center gap-2\">create-table.sql</div><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">CREATE TABLE TPCH.FP_RAW_DATA</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">(</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    CP_IDX   number(20, 0)    not null,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    WAFERID  varchar(10)      not null,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    BIN      number(10, 0)    not null,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    SITE     DOUBLE PRECISION,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    X        DOUBLE PRECISION not null,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    Y        DOUBLE PRECISION not null,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    BIN_1    DOUBLE PRECISION not null,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    BIN_2    DOUBLE PRECISION,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    BIN_3    DOUBLE PRECISION,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    -- BIN_4 ~ BIN_39 DOUBLE PRECISION</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    BIN_40   DOUBLE PRECISION,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    BIN_CODE VARCHAR(10)</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">);</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">CREATE UNIQUE INDEX TPCH.FP_RAW_IDX2 ON TPCH.FP_RAW_DATA (CP_IDX, WAFERID, X, Y);</span><br></span></code></pre></div><div class=\"absolute right-3 top-1.5 flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><p><strong>准备20,000万（2亿）行数据</strong></p><div class=\"language-oraclesqlplus rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">SELECT TABLE_NAME</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">     , NUM_ROWS</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">     , AVG_ROW_LEN</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">     , ROUND(AVG_ROW_LEN * NUM_ROWS / 1024 / 1024 / 1024, 2) AS GB</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">FROM ALL_TABLES</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">where OWNER = 'TPCH'</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">  AND TABLE_NAME = 'FP_RAW_DATA_MARS3'</span><br></span></code></pre></div><div class=\"absolute right-3 top-[9px] flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><div class=\"language-shell rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-shell bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">TABLE_NAME</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">--------------------------------------------------------------------------------</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">  NUM_ROWS AVG_ROW_LEN         GB</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">---------- ----------- ----------</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">FP_RAW_DATA_MARS3</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(170, 9, 130)\">200000000</span><span class=\"token plain\">      </span><span class=\"token number\" style=\"color:rgb(170, 9, 130)\">99</span><span class=\"token plain\">      </span><span class=\"token number\" style=\"color:rgb(170, 9, 130)\">18.44</span><br></span></code></pre></div><div class=\"absolute right-3 top-[9px] flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><p>分16个分片进行，平均每个分片处理12,500,000（1250万）行数据</p><p>脚注<sup id=\"fnref-1-784864\"><a href=\"#fn-1-784864\" class=\"footnote-ref\" rel=\"noopener dofollow\">1</a></sup></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"测试验证\">测试验证<a href=\"#测试验证\" class=\"hash-link\" aria-label=\"Direct link to 测试验证\" title=\"Direct link to 测试验证\">​</a></h2><table><thead><tr><th align=\"center\">编号</th><th align=\"left\">切分字段</th><th align=\"left\">切分方法</th></tr></thead><tbody><tr><td align=\"center\">A</td><td align=\"left\">CP_IDX</td><td align=\"left\">Range: (Minimum, Maximum)</td></tr><tr><td align=\"center\">B</td><td align=\"left\">ROWID</td><td align=\"left\">Range: (Minimum, Maximum)</td></tr><tr><td align=\"center\">C</td><td align=\"left\">ROWID</td><td align=\"left\">Range: Scan</td></tr><tr><td align=\"center\">D</td><td align=\"left\">ROWID</td><td align=\"left\">Range: DBMS_PARALLEL_EXECUTE.create_chunks_by_rowid</td></tr><tr><td align=\"center\">E</td><td align=\"left\">ROWID</td><td align=\"left\">Hash</td></tr></tbody></table><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"a-基于主键索引列按照min-max区间切分\">A: 基于主键/索引列，按照(min, max)区间切分<a href=\"#a-基于主键索引列按照min-max区间切分\" class=\"hash-link\" aria-label=\"Direct link to A: 基于主键/索引列，按照(min, max)区间切分\" title=\"Direct link to A: 基于主键/索引列，按照(min, max)区间切分\">​</a></h3><div class=\"language-oraclesqlplus rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">SELECT /*+parallel(4)*/</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    COUNT(1)       AS total</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">     , MIN(CP_IDX) AS lower</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">     , MAX(CP_IDX) AS upper</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">FROM TPCH.FP_RAW_DATA;</span><br></span></code></pre></div><div class=\"absolute right-3 top-[9px] flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"b-基于rowid按照min-max区间切分\">B: 基于ROWID，按照(min, max)区间切分<a href=\"#b-基于rowid按照min-max区间切分\" class=\"hash-link\" aria-label=\"Direct link to B: 基于ROWID，按照(min, max)区间切分\" title=\"Direct link to B: 基于ROWID，按照(min, max)区间切分\">​</a></h3><div class=\"language-oraclesqlplus rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">SELECT /*+parallel(4)*/</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    COUNT(1)      AS total</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">     , MIN(ROWID) AS lower</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">     , MAX(ROWID) AS upper</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">FROM TPCH.FP_RAW_DATA;</span><br></span></code></pre></div><div class=\"absolute right-3 top-[9px] flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"c-基于rowidscan-split-by-rows\">C: 基于ROWID，Scan, split by rows<a href=\"#c-基于rowidscan-split-by-rows\" class=\"hash-link\" aria-label=\"Direct link to C: 基于ROWID，Scan, split by rows\" title=\"Direct link to C: 基于ROWID，Scan, split by rows\">​</a></h3><div class=\"language-oraclesqlplus rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">SELECT /*+parallel(4)*/ id</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">FROM (SELECT id, ROWNUM AS rn</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">      FROM (SELECT ROWID AS id</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">            FROM TPCH.FP_RAW_DATA</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">            ORDER BY ROWID) t) x</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">WHERE MOD(rn, 12500000) = 0</span><br></span></code></pre></div><div class=\"absolute right-3 top-[9px] flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"d-dbms_parallel_execute包create_chunks_by_rowid\">D: <code>DBMS_PARALLEL_EXECUTE</code>包<code>create_chunks_by_rowid</code><a href=\"#d-dbms_parallel_execute包create_chunks_by_rowid\" class=\"hash-link\" aria-label=\"Direct link to d-dbms_parallel_execute包create_chunks_by_rowid\" title=\"Direct link to d-dbms_parallel_execute包create_chunks_by_rowid\">​</a></h3><div class=\"language-oraclesqlplus rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">BEGIN</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    DBMS_PARALLEL_EXECUTE.create_task(task_name =&gt; 'tpch_test');</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">    DBMS_PARALLEL_EXECUTE.create_chunks_by_rowid(</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">            task_name =&gt; 'tpch_test',</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">            table_owner =&gt; 'TPCH',</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">            table_name =&gt; 'FP_RAW_DATA',</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">            by_row =&gt; TRUE,</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">            chunk_size =&gt; 12500000);</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">END;</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">/</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">SELECT chunk_id, status, start_rowid, end_rowid</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">FROM user_parallel_execute_chunks</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">WHERE task_name = 'tpch_test'</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">ORDER BY chunk_id;</span><br></span></code></pre></div><div class=\"absolute right-3 top-[9px] flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"e-基于rowidhash切分\">E: 基于ROWID，Hash切分<a href=\"#e-基于rowidhash切分\" class=\"hash-link\" aria-label=\"Direct link to E: 基于ROWID，Hash切分\" title=\"Direct link to E: 基于ROWID，Hash切分\">​</a></h3><div class=\"language-oraclesqlplus rounded-md bg-gray-50 dark:bg-gray-800 border dark:border-gray-700 mb-6 relative\"><div class=\"py-3 px-4 text-[13px] leading-5 text-gray-600 dark:text-gray-300 border-b dark:border-b-gray-700 font-mono flex items-center gap-2\">hello.sql</div><div class=\"relative pt-3 pb-0 not-prose\"><pre tabindex=\"0\" class=\"prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3\"><code class=\"bg-transparent inline-block min-w-full\"><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">SELECT *</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">FROM TPCH.FP_RAW_DATA</span><br></span><span class=\"token-line px-4 text-xs sm:text-sm 2xl:text-sm\" style=\"color:#403f53\"><span class=\"token plain\">WHERE MOD(DBMS_ROWID.ROWID_ROW_NUMBER(TPCH.FP_RAW_DATA.ROWID), 16) = 0</span><br></span></code></pre></div><div class=\"absolute right-3 top-1.5 flex items-center gap-2\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy code to clipboard\" class=\"w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-900 rounded group transition-[background-color] duration-200 ease-in-out\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" class=\"w-4 h-4 text-gray-400 dark:text-gray-500 transition-all duration-200 ease-in-out\"><path fill=\"currentColor\" d=\"M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z\"></path><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z\" clip-rule=\"evenodd\"></path></svg></button></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"结论\">结论<a href=\"#结论\" class=\"hash-link\" aria-label=\"Direct link to 结论\" title=\"Direct link to 结论\">​</a></h2><div class=\"rounded-lg admonition admonition-tip mb-6 bg-refine-green bg-opacity-10 border-l-refine-green\"><div class=\"border-l-4 border-l-solid border-l-inherit rounded-tl-lg rounded-bl-lg p-4 flex flex-col gap-2 sm:gap-4\"><div class=\"flex items-center gap-2 text-xs sm:text-base 2xl:text-base 2xl:leading-7 font-semibold text-refine-green\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"><path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M18 10c0 2.22-1.206 4.16-3 5.197V16a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-.803A6 6 0 1 1 18 10Zm-7.414-1.414a1 1 0 0 0-1.414-1.414A3.99 3.99 0 0 0 8 10a3.99 3.99 0 0 0 1.172 2.828 1 1 0 0 0 1.414-1.414A1.99 1.99 0 0 1 10 10c0-.553.223-1.051.586-1.414Z\" clip-rule=\"evenodd\"></path><path fill=\"currentColor\" d=\"M11 18a1 1 0 0 0 0 2h2a1 1 0 0 0 0-2h-2Z\"></path></svg><span class=\"uppercase\">TIP</span></div><div class=\"text-gray-0 text-base last:mb-0\"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum\ntempor eros aliquam consequat. Lorem ipsum dolor sit amet</p></div></div></div><ol><li>在我们的场景中，允许<code>Partitioned Table</code>?</li><li>优先使用 <code>DBMS_PARALLEL_EXECUTE</code>包中的<code>create_chunks_by_rowid</code>方法，获取基于<code>ROWID</code>切分；</li><li>如果因为版本兼容性或者权限等原因导致1失败，则尝试采用；</li><li>啦啦啦</li></ol><div class=\"footnotes\"><hr><ol><li id=\"fn-1-784864\"><a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_PARALLEL_EXECUTE.html\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Oracle DBMS_PARALLEL_EXECUTE</a><a href=\"#fnref-1-784864\" class=\"footnote-backref\" rel=\"noopener dofollow\">↩</a></li></ol></div>",
            "url": "https://1stblue.github.io/en/blog/oracle-split-read",
            "title": "Oracle大表的并行读取",
            "summary": "测试环境",
            "date_modified": "2023-10-11T00:00:00.000Z",
            "author": {
                "name": "aleafs",
                "url": "https://github.com/aleafs"
            },
            "tags": [
                "Oracle",
                "ROWID",
                "并行"
            ]
        }
    ]
}