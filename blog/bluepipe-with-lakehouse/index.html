<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">构建跨网络数据管道最佳实践 | Bluepipe - 数据因自由流动而价值无限</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://www.1stblue.com/blog/bluepipe-with-lakehouse"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="fr"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="构建跨网络数据管道最佳实践 | Bluepipe - 数据因自由流动而价值无限"><meta data-rh="true" name="description" content="本文以云器 Lakehouse 为例，介绍利用bluepipe构建跨网络的数据复制最佳实践。"><meta data-rh="true" property="og:description" content="本文以云器 Lakehouse 为例，介绍利用bluepipe构建跨网络的数据复制最佳实践。"><meta data-rh="true" property="og:image" content="https://www.1stblue.com/img/blog-static/cover-bridge.jpeg"><meta data-rh="true" name="twitter:image" content="https://www.1stblue.com/img/blog-static/cover-bridge.jpeg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-06-21T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/aleafs"><meta data-rh="true" property="article:tag" content="lakehouse,network,Oracle"><link data-rh="true" rel="icon" href="/favicon.svg"><link data-rh="true" rel="canonical" href="https://www.1stblue.com/blog/bluepipe-with-lakehouse"><link data-rh="true" rel="alternate" href="https://www.1stblue.com/blog/bluepipe-with-lakehouse" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.1stblue.com/fr/blog/bluepipe-with-lakehouse" hreflang="fr"><link data-rh="true" rel="alternate" href="https://www.1stblue.com/es/blog/bluepipe-with-lakehouse" hreflang="es"><link data-rh="true" rel="alternate" href="https://www.1stblue.com/blog/bluepipe-with-lakehouse" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://www.1stblue.com/blog/bluepipe-with-lakehouse","mainEntityOfPage":"https://www.1stblue.com/blog/bluepipe-with-lakehouse","url":"https://www.1stblue.com/blog/bluepipe-with-lakehouse","headline":"构建跨网络数据管道最佳实践","name":"构建跨网络数据管道最佳实践","description":"本文以云器 Lakehouse 为例，介绍利用bluepipe构建跨网络的数据复制最佳实践。","datePublished":"2024-06-21T00:00:00.000Z","author":{"@type":"Person","name":"aleafs","description":"大龄程序员","url":"https://github.com/aleafs","image":"https://avatars.githubusercontent.com/u/535479"},"image":{"@type":"ImageObject","@id":"https://www.1stblue.com/img/blog-static/cover-bridge.jpeg","url":"https://www.1stblue.com/img/blog-static/cover-bridge.jpeg","contentUrl":"https://www.1stblue.com/img/blog-static/cover-bridge.jpeg","caption":"title image for the blog post: 构建跨网络数据管道最佳实践"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://www.1stblue.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Bluepipe - 数据因自由流动而价值无限 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Bluepipe - 数据因自由流动而价值无限 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.8a7faa81.css">
<script src="/assets/js/runtime~main.491a8cb7.js" defer="defer"></script>
<script src="/assets/js/main.0f8cc772.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div><div class="m-auto w-full navbar z-30 fixed"><header class="w-[1120px] m-auto py-[12px] h-[56px]"><nav class="flex justify-between items-center"><div class="w-[45%] flex justify-between items-center"><div class="w-[30%]"><a href="/"><img src="/logo.svg" alt="logo" width="103" height="24"></a></div><div class="w-[70%] flex gap-[40px]"><a class="relative text-[14px] group no-underline hover:no-underline hover:text-current" href="/">首页<span class="absolute left-0 bottom-[-2px] w-full h-[1px] bg-black origin-bottom scale-y-0 translate-y-[1px] transition-transform duration-200 ease-in-out group-hover:scale-y-100 group-hover:translate-y-0"></span></a><a class="relative text-[14px] group no-underline hover:no-underline hover:text-current" href="/price">价格<span class="absolute left-0 bottom-[-2px] w-full h-[1px] bg-black origin-bottom scale-y-0 translate-y-[1px] transition-transform duration-200 ease-in-out group-hover:scale-y-100 group-hover:translate-y-0"></span></a></div></div><div class="w-[40%] flex justify-between items-center"><div class="w-[55%]"></div><div class="w-[45%] flex justify-between items-center"><div class="my-[4px] flex text-[14px] space-x-0"></div><div><button class="relative px-[24px] p-auto h-[32px] font-sans font-[400] text-[#000000] text-center overflow-hidden group bg-bp-blue-1 w-[104px] h-[32px] mr-0 rounded-[100px]"><span class="h-[20px] text-[14px] leading-[20px] text-center inline-block transition-transform duration-300 ease-in-out group-hover:-translate-x-2 text-white">申请试用</span><span class="absolute inset-y-0 right-5 flex items-center opacity-0 group-hover:opacity-100 group-hover:translate-x-2 transition-all duration-300 ease-in-out"><img src="/white-arrow.svg" alt="arrow"></span></button></div></div></div></nav></header></div><div class="fixed mt-[56px] z-10 w-full h-0.5 translate"><div class="h-full bg-blue-500" style="width:0%"></div></div></div><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="margin-vert--lg flex"><div class="flex-1 flex"><main class="w-full mt-[36px]"><article><div class="text-sm"><div class="flex justify-between sm:flex-row flex-col"><div class="flex justify-center items-center gap-2 pl-[32px]"><a class="!text-gray-500 hover:text-bp-blue-1 text-sm no-underline">← 返回博客</a></div><div class="flex items-center gap-2 text-gray-600 mr-[32px]"><time datetime="2024-06-21T00:00:00.000Z" itemprop="datePublished">2024年06月21日</time><span class="w-[4px] h-[4px] rounded-full bg-gray-600"></span>4 min read<a class="cursor-pointer text-bp-blue-1">下载</a></div></div></div><div class="p-[32px] bluepipe-prose-blog-content"><h1 itemprop="headline">构建跨网络数据管道最佳实践</h1><div id="__blog-post-container" class="markdown" itemprop="articleBody"><div class="avatar margin-bottom--sm mt-[10px] mb-[40px]"><a href="https://github.com/aleafs" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_GKcB" src="https://avatars.githubusercontent.com/u/535479" alt="aleafs"></a><div class="avatar__intro authorDetails_uciD"><div class="avatar__name"><a href="https://github.com/aleafs" target="_blank" rel="noopener noreferrer"><span class="authorName_r1JK">aleafs</span></a></div><small class="authorTitle_ym37" title="大龄程序员">大龄程序员</small><div class="authorSocials_OQLn"></div></div></div><p>本文以<a href="https://yunqi.tech/" target="_blank" rel="noopener noreferrer">云器</a> <code>Lakehouse</code> 为例，介绍利用<code>bluepipe</code>构建跨网络的数据复制最佳实践。</p>
<p>如下图，客户业务系统部署在私有 IDC 中，而<code>Lakehouse</code>作为多租户湖仓服务部署在云上。数据需要从<code>Oracle</code>同步到<code>Lakehouse</code>
，我们推荐将<code>bluepipe</code>部署在客户 IDC 中，<strong>推</strong>数据 到<code>Lakehouse</code>。</p>
<p><img decoding="async" loading="lazy" alt="Oracle to Lakehouse" src="/assets/images/cross-network-pipe-eddbc84234790986facb8dda2658652e.png" width="2350" height="520" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="方案优势">方案优势<a href="#方案优势" class="hash-link" aria-label="Direct link to 方案优势" title="Direct link to 方案优势">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="开箱即用10-分钟完成配置">开箱即用，10 分钟完成配置<a href="#开箱即用10-分钟完成配置" class="hash-link" aria-label="Direct link to 开箱即用，10 分钟完成配置" title="Direct link to 开箱即用，10 分钟完成配置">​</a></h3>
<ul>
<li><code>bluepipe</code>几乎可以运行在任何<code>Linux</code>系统中，支持<code>x86</code>和<code>arm</code>芯片；常见的机架式服务器、笔记本电脑，甚至树莓派都可以用来部署；</li>
<li>极简的配置过程，默认参数即可达到最佳性能。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="全增量一体化无需运维干预">全、增量一体化，无需运维干预<a href="#全增量一体化无需运维干预" class="hash-link" aria-label="Direct link to 全、增量一体化，无需运维干预" title="Direct link to 全、增量一体化，无需运维干预">​</a></h3>
<ul>
<li>全量同步与增量同步深度协同，几乎无需日常运维操作；</li>
<li>高效的数据比对与热修复技术，始终保证数据一致；</li>
<li>高度鲁棒的<code>Schema Evolution</code>。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="推数据而不是暴露端口">推数据，而不是暴露端口<a href="#推数据而不是暴露端口" class="hash-link" aria-label="Direct link to 推数据，而不是暴露端口" title="Direct link to 推数据，而不是暴露端口">​</a></h3>
<ul>
<li><code>bluepipe</code>与您的数据库一起部署在您的内网，无需对外暴  露端口；</li>
<li>弹性<code>buffer size</code>技术，在<code>吞吐(Throughput)</code>和<code>延迟(latency)</code>之间自动平衡。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="oracle-链路的独特优势">Oracle 链路的独特优势<a href="#oracle-链路的独特优势" class="hash-link" aria-label="Direct link to Oracle 链路的独特优势" title="Direct link to Oracle 链路的独特优势">​</a></h2>
<p><code>bluepipe</code>基于<code>Oracle LogMiner</code>实现对变更数据的捕捉。与此同时，在以下几个方面做了深度优化：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="对-ddl-行为的深度兼容">对 DDL 行为的深度兼容<a href="#对-ddl-行为的深度兼容" class="hash-link" aria-label="Direct link to 对 DDL 行为的深度兼容" title="Direct link to 对 DDL 行为的深度兼容">​</a></h3>
<p>在<code>LogMiner</code>默认策略下，当发生<code>DDL</code>行为后，相关表上后续的<code>DML</code>操作均无法正确解析，从而导致无法正确捕捉到变更。</p>
<p><code>bluepipe</code>维护了字典文件的自动构建策略，保证表结构变更后仍然能捕捉到正确的增量数据。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="大事务优化">大事务优化<a href="#大事务优化" class="hash-link" aria-label="Direct link to 大事务优化" title="Direct link to 大事务优化">​</a></h3>
<p><code>Oracle Redo Log</code>中记录了完整的事务(<code>Transaction</code>)过程，而业务上通常仅希望拿到<code>commit</code>
之后的数据，因此，需要在传输过程中使用<code>buffer</code>来暂存尚未<code>commit</code>的变更记录。</p>
<p><code>bluepipe</code>基于独特的内存管理技术，单节点上也能轻松应对千万量级的大事务。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="全面支持名称超过-30-字符的表">全面支持名称超过 30 字符的表<a href="#全面支持名称超过-30-字符的表" class="hash-link" aria-label="Direct link to 全面支持名称超过 30 字符的表" title="Direct link to 全面支持名称超过 30 字符的表">​</a></h3>
<p><code>Oracle 12.2</code>版本之后，对表名、字段名的最大长度支持到了 128 字节。
但因为种种原因，<code>LogMiner</code>对于无<code>OGG LICENSE</code>的实例，至今仍不支持对包含长名称的表的 DML
解析，详情参考<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/sutil/oracle-logminer-utility.html" target="_blank" rel="noopener noreferrer">官方文档</a>。</p>
<p><code>bluepipe</code>基于高效的流批融合技术，全面支持了此种情况下的增量数据捕捉与投递。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="适配支持-rac-架构">适配支持 RAC 架构<a href="#适配支持-rac-架构" class="hash-link" aria-label="Direct link to 适配支持 RAC 架构" title="Direct link to 适配支持 RAC 架构">​</a></h3></div></div></article><nav class="pagination-nav docusaurus-mt-lg px-[32px]" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/v0.11.0-release-notes"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">Release Notes (v.0.11.0)</div></a></nav></main></div><div class="flex-shrink-0"><div class="tableOfContents_jeP5 thin-scrollbar"><div><div><ul class="table-of-contents table-of-contents__left-border mt-[20px]"><li><a href="#方案优势" class="table-of-contents__link toc-highlight">方案优势</a><div><ul><li><a href="#开箱即用10-分钟完成配置" class="table-of-contents__link toc-highlight">开箱即用，10 分钟完成配置</a></li><li><a href="#全增量一体化无需运维干预" class="table-of-contents__link toc-highlight">全、增量一体化，无需运维干预</a></li><li><a href="#推数据而不是暴露端口" class="table-of-contents__link toc-highlight">推数据，而不是暴露端口</a></li></ul></div></li><li><a href="#oracle-链路的独特优势" class="table-of-contents__link toc-highlight">Oracle 链路的独特优势</a><div><ul><li><a href="#对-ddl-行为的深度兼容" class="table-of-contents__link toc-highlight">对 DDL 行为的深度兼容</a></li><li><a href="#大事务优化" class="table-of-contents__link toc-highlight">大事务优化</a></li><li><a href="#全面支持名称超过-30-字符的表" class="table-of-contents__link toc-highlight">全面支持名称超过 30 字符的表</a></li><li><a href="#适配支持-rac-架构" class="table-of-contents__link toc-highlight">适配支持 RAC 架构</a></li></ul></div></li></ul></div></div></div></div></div></div><footer class="bg-black text-white"><div class="max-w-[1920px] m-auto"><div class="w-[1120px] m-auto bg-black"><div class="flex flex-col py-[83px] gap-[82px]"><div class="flex justify-between"><div class="text-white"><img src="/logo-footer.svg" alt="logo" width="124.02" height="28.8"><div class="mt-[31.2px]"><p class="mt-[12px] font-sans font-[400] text-[16px] leading-[28px]">余杭区仓前街道海创科技中心 3 幢</p><p class="mt-[12px] font-sans font-[400] text-[16px] leading-[19px]"><a href="mailto:sales@1stblue.com" class="relative text-[14px] group hover:no-underline hover:text-current">sales@1stblue.com<span class="absolute left-0 bottom-[-2px] w-full h-[1px] bg-white origin-bottom scale-y-0 translate-y-[1px] transition-transform duration-200 ease-in-out group-hover:scale-y-100 group-hover:translate-y-0"></span></a></p></div></div><div class="flex"><div><div class="font-sans font-[600] text-[14px] leading-[33.6px]">官网</div><div class="mt-[18px] font-sans font-[400] text-[14px] leading-[33.6px]"><div><a class="relative text-[14px] group hover:no-underline hover:text-current" href="/">首页<span class="absolute left-0 bottom-[-2px] w-full h-[1px] bg-white origin-bottom scale-y-0 translate-y-[1px] transition-transform duration-200 ease-in-out group-hover:scale-y-100 group-hover:translate-y-0"></span></a></div><div><a class="relative text-[14px] group hover:no-underline hover:text-current" href="/price">价格<span class="absolute left-0 bottom-[-2px] w-full h-[1px] bg-white origin-bottom scale-y-0 translate-y-[1px] transition-transform duration-200 ease-in-out group-hover:scale-y-100 group-hover:translate-y-0"></span></a></div></div></div></div></div><div class="h-[49px] flex justify-between text-[#FFFFFF] border-t-[1px] border-[#FFFFFF4D]"><div class="mt-[32px] font-sans font-[400] text-[12px] leading-[16.8px]">© 2022-2024 杭州萃蓝网络科技有限公司 保留所有权利</div><div class="mt-[32px] font-sans font-[400] text-[12px] leading-[17px] text-right"><a href="https://beian.miit.gov.cn" target="_blank" rel="noopener noreferrer" class="relative group hover:no-underline hover:text-current">浙ICP备2024076741号<span class="absolute left-0 bottom-[-2px] w-full h-[1px] bg-white origin-bottom scale-y-0 translate-y-[1px] transition-transform duration-200 ease-in-out group-hover:scale-y-100 group-hover:translate-y-0"></span></a></div></div></div></div></div></footer></div>
</body>
</html>