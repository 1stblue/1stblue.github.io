<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>1stblue.com Blog</title>
        <link>https://1stblue.github.io/blog</link>
        <description>1stblue.com Blog</description>
        <lastBuildDate>Fri, 29 Dec 2023 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-Hans</language>
        <copyright>Copyright © 2023 1stblue.</copyright>
        <item>
            <title><![CDATA[Release Notes (v2023)]]></title>
            <link>https://1stblue.github.io/blog/v2023-release-notes</link>
            <guid>https://1stblue.github.io/blog/v2023-release-notes</guid>
            <pubDate>Fri, 29 Dec 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[2024年来临之际，我很荣幸地代表团队向大家宣布bluepipe2023年度版本的诞生。]]></description>
            <content:encoded><![CDATA[<p>2024年来临之际，我很荣幸地代表团队向大家宣布<code>bluepipe</code>2023年度版本的诞生。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="背景">背景<a href="#背景" class="hash-link" aria-label="背景的直接链接" title="背景的直接链接">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-changed">What's Changed<a href="#whats-changed" class="hash-link" aria-label="What's Changed的直接链接" title="What's Changed的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="全新交互">全新交互<a href="#全新交互" class="hash-link" aria-label="全新交互的直接链接" title="全新交互的直接链接">​</a></h3><ul><li>面向<strong>数据交付</strong>而不是面向作业的全新交互，带来用户体验极大提升；</li><li>您只需要关注数据表的复制状态，而不是思考怎么配置一个个作业。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="流批融合">流批融合<a href="#流批融合" class="hash-link" aria-label="流批融合的直接链接" title="流批融合的直接链接">​</a></h3><ul><li>在来源库支持了CDC的作业中，我们优先选择使用CDC方式来复制增量数据；</li><li>对同一张数据表而言，基于SQL查询的<code>批量复制</code>与基于CDC技术的<code>流式复制</code>无缝衔接；</li><li>一键封装<code>重刷数据</code>的功能；确保<strong>应急响应</strong>场景下，无需人工思考流批冲突的问题。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="游标列">游标列<a href="#游标列" class="hash-link" aria-label="游标列的直接链接" title="游标列的直接链接">​</a></h3><ul><li>支持为每张表单独设置时间类型的<code>游标列</code>以实现<strong>批量复制</strong>模式下的<strong>增量同步</strong>能力。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="筛选与重命名">筛选与重命名<a href="#筛选与重命名" class="hash-link" aria-label="筛选与重命名的直接链接" title="筛选与重命名的直接链接">​</a></h3><ul><li>控制台开放<code>表</code>和<code>字段</code>的筛选与重命名功能。</li></ul><div class="rounded-lg admonition admonition-caution mb-6 bg-[#F2800D]/10 bg-opacity-10 border-l-bluepipe-orange"><div class="border-l-4 border-l-solid border-l-inherit rounded-tl-lg rounded-bl-lg p-4 flex flex-col gap-2 sm:gap-4"><div class="flex items-center gap-2 text-xs sm:text-base 2xl:text-base 2xl:leading-7 font-semibold text-[#F2800D]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M13.789 5.106a2 2 0 0 0-3.578 0l-6 12A2 2 0 0 0 6 20h12a2 2 0 0 0 1.789-2.894l-6-12ZM13 15a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-2-6a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0V9Z" clip-rule="evenodd"></path></svg><span class="uppercase">CAUTION</span></div><div class="text-gray-0 text-base last:mb-0"><p>重新定义表名或者字段名不会影响正在运行或者运行结束的作业，新的配置会在作业下次启动时加载。
因此有可能您需要做完相关修改后人工进行 <strong>重刷数据</strong>.</p></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="连接器">连接器<a href="#连接器" class="hash-link" aria-label="连接器的直接链接" title="连接器的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clickzetta">ClickZetta<a href="#clickzetta" class="hash-link" aria-label="ClickZetta的直接链接" title="ClickZetta的直接链接">​</a></h3><ul><li><strong>ClickZetta</strong>是<a href="https://www.yunqi.tech" target="_blank" rel="noopener noreferrer nofollow">云器科技</a>研发的多云及一体化数据平台；</li><li>当前仅支持数据写入。</li></ul><div class="rounded-lg admonition admonition-caution mb-6 bg-[#F2800D]/10 bg-opacity-10 border-l-bluepipe-orange"><div class="border-l-4 border-l-solid border-l-inherit rounded-tl-lg rounded-bl-lg p-4 flex flex-col gap-2 sm:gap-4"><div class="flex items-center gap-2 text-xs sm:text-base 2xl:text-base 2xl:leading-7 font-semibold text-[#F2800D]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M13.789 5.106a2 2 0 0 0-3.578 0l-6 12A2 2 0 0 0 6 20h12a2 2 0 0 0 1.789-2.894l-6-12ZM13 15a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-2-6a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0V9Z" clip-rule="evenodd"></path></svg><span class="uppercase">CAUTION</span></div><div class="text-gray-0 text-base last:mb-0"><p>受<code>ClickZetta</code>当前版本限制，对于含 <code>Primary Key</code>的表，目前仅支持单线程写入。<code>bluepipe</code>自动进行了适配，无<code>Primary Key</code>
的表仍然可以多线程大吞吐写入。</p></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="intersystems">InterSystems<a href="#intersystems" class="hash-link" aria-label="InterSystems的直接链接" title="InterSystems的直接链接">​</a></h3><ul><li>支持<a href="https://www.intersystems.com/data-platform/" target="_blank" rel="noopener noreferrer nofollow"><code>InterSystems IRIS</code></a>批量读取；</li><li>支持<a href="https://www.intersystems.com/cache/" target="_blank" rel="noopener noreferrer nofollow"><code>InterSystems Caché</code></a>批量读取。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="apache-hive">Apache Hive<a href="#apache-hive" class="hash-link" aria-label="Apache Hive的直接链接" title="Apache Hive的直接链接">​</a></h3><ul><li>支持<a href="https://cwiki.apache.org/confluence/display/hive/hiveserver2+clients#HiveServer2Clients-ConnectionURLWhenZooKeeperServiceDiscoveryIsEnabled" target="_blank" rel="noopener noreferrer nofollow"><code>Zookeeper Service Discovery</code></a>配置。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="遗留问题">遗留问题<a href="#遗留问题" class="hash-link" aria-label="遗留问题的直接链接" title="遗留问题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="流批融合-1">流批融合<a href="#流批融合-1" class="hash-link" aria-label="流批融合的直接链接" title="流批融合的直接链接">​</a></h3><ul><li>表之间相互干扰</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="游标列-1">游标列<a href="#游标列-1" class="hash-link" aria-label="游标列的直接链接" title="游标列的直接链接">​</a></h3><ul><li><code>游标列</code>本质上是一个业务字段，需要应用系统在进行数据更新时<strong>一并</strong>更新此字段。但这个行为并不总是可靠，并且，对于物理删除的行，我们将无法感知到其不存在。</li></ul><p>因此，使用<code>游标列</code>进行增量复制存在原理上的缺陷，而这个缺陷不是<code>bluepipe</code>能够控制的，使用时您需要慎重评估。</p><ul><li>值对齐：当前版本以<code>游标列</code>进行过滤数据，采用 <strong>大于等于（&gt;=）</strong> <strong>前值</strong>的策略；但在生产实践中，往往需要将 <strong>前值</strong>
向前对齐到某个特定值再进行使用。我们会根据反馈在后续版本中计划此功能。</li></ul>]]></content:encoded>
            <category>Release Notes</category>
            <category>v2023</category>
        </item>
        <item>
            <title><![CDATA[Oracle大表的并行读取]]></title>
            <link>https://1stblue.github.io/blog/oracle-split-read</link>
            <guid>https://1stblue.github.io/blog/oracle-split-read</guid>
            <pubDate>Wed, 11 Oct 2023 00:00:00 GMT</pubDate>
            <description><![CDATA[测试环境]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="测试环境">测试环境<a href="#测试环境" class="hash-link" aria-label="测试环境的直接链接" title="测试环境的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="硬件">硬件<a href="#硬件" class="hash-link" aria-label="硬件的直接链接" title="硬件的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据">数据<a href="#数据" class="hash-link" aria-label="数据的直接链接" title="数据的直接链接">​</a></h3><p><strong>表结构</strong></p><div class="language-oraclesqlplus rounded-md bg-gray-50 border mb-6 relative"><div class="py-3 px-4 text-[13px] leading-5 text-gray-600 border-b font-mono flex items-center gap-2">create-table.sql</div><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">CREATE TABLE TPCH.FP_RAW_DATA</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">(</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    CP_IDX   number(20, 0)    not null,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    WAFERID  varchar(10)      not null,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    BIN      number(10, 0)    not null,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    SITE     DOUBLE PRECISION,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    X        DOUBLE PRECISION not null,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    Y        DOUBLE PRECISION not null,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    BIN_1    DOUBLE PRECISION not null,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    BIN_2    DOUBLE PRECISION,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    BIN_3    DOUBLE PRECISION,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    -- BIN_4 ~ BIN_39 DOUBLE PRECISION</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    BIN_40   DOUBLE PRECISION,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    BIN_CODE VARCHAR(10)</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">);</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">CREATE UNIQUE INDEX TPCH.FP_RAW_IDX2 ON TPCH.FP_RAW_DATA (CP_IDX, WAFERID, X, Y);</span><br></span></code></pre></div><div class="absolute right-3 top-1.5 flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><p><strong>准备20,000万（2亿）行数据</strong></p><div class="language-oraclesqlplus rounded-md bg-gray-50 border mb-6 relative"><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">SELECT TABLE_NAME</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">     , NUM_ROWS</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">     , AVG_ROW_LEN</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">     , ROUND(AVG_ROW_LEN * NUM_ROWS / 1024 / 1024 / 1024, 2) AS GB</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">FROM ALL_TABLES</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">where OWNER = 'TPCH'</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">  AND TABLE_NAME = 'FP_RAW_DATA_MARS3'</span><br></span></code></pre></div><div class="absolute right-3 top-[9px] flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><div class="language-shell rounded-md bg-gray-50 border mb-6 relative"><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-shell bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">TABLE_NAME</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">--------------------------------------------------------------------------------</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">  NUM_ROWS AVG_ROW_LEN         GB</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">---------- ----------- ----------</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">FP_RAW_DATA_MARS3</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">200000000</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">99</span><span class="token plain">      </span><span class="token number" style="color:rgb(170, 9, 130)">18.44</span><br></span></code></pre></div><div class="absolute right-3 top-[9px] flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><p>分16个分片进行，平均每个分片处理12,500,000（1250万）行数据</p><p>脚注<sup id="fnref-1-784864"><a href="#fn-1-784864" class="footnote-ref" rel="noopener dofollow">1</a></sup></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="测试验证">测试验证<a href="#测试验证" class="hash-link" aria-label="测试验证的直接链接" title="测试验证的直接链接">​</a></h2><table><thead><tr><th align="center">编号</th><th align="left">切分字段</th><th align="left">切分方法</th></tr></thead><tbody><tr><td align="center">A</td><td align="left">CP_IDX</td><td align="left">Range: (Minimum, Maximum)</td></tr><tr><td align="center">B</td><td align="left">ROWID</td><td align="left">Range: (Minimum, Maximum)</td></tr><tr><td align="center">C</td><td align="left">ROWID</td><td align="left">Range: Scan</td></tr><tr><td align="center">D</td><td align="left">ROWID</td><td align="left">Range: DBMS_PARALLEL_EXECUTE.create_chunks_by_rowid</td></tr><tr><td align="center">E</td><td align="left">ROWID</td><td align="left">Hash</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-基于主键索引列按照min-max区间切分">A: 基于主键/索引列，按照(min, max)区间切分<a href="#a-基于主键索引列按照min-max区间切分" class="hash-link" aria-label="A: 基于主键/索引列，按照(min, max)区间切分的直接链接" title="A: 基于主键/索引列，按照(min, max)区间切分的直接链接">​</a></h3><div class="language-oraclesqlplus rounded-md bg-gray-50 border mb-6 relative"><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">SELECT /*+parallel(4)*/</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    COUNT(1)       AS total</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">     , MIN(CP_IDX) AS lower</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">     , MAX(CP_IDX) AS upper</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">FROM TPCH.FP_RAW_DATA;</span><br></span></code></pre></div><div class="absolute right-3 top-[9px] flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="b-基于rowid按照min-max区间切分">B: 基于ROWID，按照(min, max)区间切分<a href="#b-基于rowid按照min-max区间切分" class="hash-link" aria-label="B: 基于ROWID，按照(min, max)区间切分的直接链接" title="B: 基于ROWID，按照(min, max)区间切分的直接链接">​</a></h3><div class="language-oraclesqlplus rounded-md bg-gray-50 border mb-6 relative"><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">SELECT /*+parallel(4)*/</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    COUNT(1)      AS total</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">     , MIN(ROWID) AS lower</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">     , MAX(ROWID) AS upper</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">FROM TPCH.FP_RAW_DATA;</span><br></span></code></pre></div><div class="absolute right-3 top-[9px] flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="c-基于rowidscan-split-by-rows">C: 基于ROWID，Scan, split by rows<a href="#c-基于rowidscan-split-by-rows" class="hash-link" aria-label="C: 基于ROWID，Scan, split by rows的直接链接" title="C: 基于ROWID，Scan, split by rows的直接链接">​</a></h3><div class="language-oraclesqlplus rounded-md bg-gray-50 border mb-6 relative"><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">SELECT /*+parallel(4)*/ id</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">FROM (SELECT id, ROWNUM AS rn</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">      FROM (SELECT ROWID AS id</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">            FROM TPCH.FP_RAW_DATA</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">            ORDER BY ROWID) t) x</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">WHERE MOD(rn, 12500000) = 0</span><br></span></code></pre></div><div class="absolute right-3 top-[9px] flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="d-dbms_parallel_execute包create_chunks_by_rowid">D: <code>DBMS_PARALLEL_EXECUTE</code>包<code>create_chunks_by_rowid</code><a href="#d-dbms_parallel_execute包create_chunks_by_rowid" class="hash-link" aria-label="d-dbms_parallel_execute包create_chunks_by_rowid的直接链接" title="d-dbms_parallel_execute包create_chunks_by_rowid的直接链接">​</a></h3><div class="language-oraclesqlplus rounded-md bg-gray-50 border mb-6 relative"><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">BEGIN</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    DBMS_PARALLEL_EXECUTE.create_task(task_name =&gt; 'tpch_test');</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">    DBMS_PARALLEL_EXECUTE.create_chunks_by_rowid(</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">            task_name =&gt; 'tpch_test',</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">            table_owner =&gt; 'TPCH',</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">            table_name =&gt; 'FP_RAW_DATA',</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">            by_row =&gt; TRUE,</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">            chunk_size =&gt; 12500000);</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">END;</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">/</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">SELECT chunk_id, status, start_rowid, end_rowid</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">FROM user_parallel_execute_chunks</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">WHERE task_name = 'tpch_test'</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">ORDER BY chunk_id;</span><br></span></code></pre></div><div class="absolute right-3 top-[9px] flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="e-基于rowidhash切分">E: 基于ROWID，Hash切分<a href="#e-基于rowidhash切分" class="hash-link" aria-label="E: 基于ROWID，Hash切分的直接链接" title="E: 基于ROWID，Hash切分的直接链接">​</a></h3><div class="language-oraclesqlplus rounded-md bg-gray-50 border mb-6 relative"><div class="py-3 px-4 text-[13px] leading-5 text-gray-600 border-b font-mono flex items-center gap-2">hello.sql</div><div class="relative pt-3 pb-0 not-prose"><pre tabindex="0" class="prism-code language-oraclesqlplus bg-transparent !mt-0 !mb-0 m-0 px-0 pt-0 font-mono pb-3"><code class="bg-transparent inline-block min-w-full"><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">SELECT *</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">FROM TPCH.FP_RAW_DATA</span><br></span><span class="token-line px-4 text-xs sm:text-sm 2xl:text-sm" style="color:#403f53"><span class="token plain">WHERE MOD(DBMS_ROWID.ROWID_ROW_NUMBER(TPCH.FP_RAW_DATA.ROWID), 16) = 0</span><br></span></code></pre></div><div class="absolute right-3 top-1.5 flex items-center gap-2"><button type="button" aria-label="Copy code to clipboard" title="Copy code to clipboard" class="w-8 h-8 flex justify-center items-center bg-gray-50 hover:bg-gray-100 rounded group transition-[background-color] duration-200 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="w-4 h-4 text-gray-400 transition-all duration-200 ease-in-out"><path fill="currentColor" d="M0 3a3 3 0 0 1 3-3h8a1 1 0 1 1 0 2H3a1 1 0 0 0-1 1v8a1 1 0 1 1-2 0V3Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4 6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6Zm10 0H6v8h8V6Z" clip-rule="evenodd"></path></svg></button></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="结论">结论<a href="#结论" class="hash-link" aria-label="结论的直接链接" title="结论的直接链接">​</a></h2><div class="rounded-lg admonition admonition-tip mb-6 bg-bluepipe-green bg-opacity-10 border-l-bluepipe-green"><div class="border-l-4 border-l-solid border-l-inherit rounded-tl-lg rounded-bl-lg p-4 flex flex-col gap-2 sm:gap-4"><div class="flex items-center gap-2 text-xs sm:text-base 2xl:text-base 2xl:leading-7 font-semibold text-bluepipe-green"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill="currentColor" fill-rule="evenodd" d="M18 10c0 2.22-1.206 4.16-3 5.197V16a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-.803A6 6 0 1 1 18 10Zm-7.414-1.414a1 1 0 0 0-1.414-1.414A3.99 3.99 0 0 0 8 10a3.99 3.99 0 0 0 1.172 2.828 1 1 0 0 0 1.414-1.414A1.99 1.99 0 0 1 10 10c0-.553.223-1.051.586-1.414Z" clip-rule="evenodd"></path><path fill="currentColor" d="M11 18a1 1 0 0 0 0 2h2a1 1 0 0 0 0-2h-2Z"></path></svg><span class="uppercase">TIP</span></div><div class="text-gray-0 text-base last:mb-0"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum
tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p></div></div></div><ol><li>在我们的场景中，允许<code>Partitioned Table</code>?</li><li>优先使用 <code>DBMS_PARALLEL_EXECUTE</code>包中的<code>create_chunks_by_rowid</code>方法，获取基于<code>ROWID</code>切分；</li><li>如果因为版本兼容性或者权限等原因导致1失败，则尝试采用；</li><li>啦啦啦</li></ol><div class="footnotes"><hr><ol><li id="fn-1-784864"><a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_PARALLEL_EXECUTE.html" target="_blank" rel="noopener noreferrer nofollow">Oracle DBMS_PARALLEL_EXECUTE</a><a href="#fnref-1-784864" class="footnote-backref" rel="noopener dofollow">↩</a></li></ol></div>]]></content:encoded>
            <category>Oracle</category>
            <category>ROWID</category>
            <category>并行</category>
        </item>
    </channel>
</rss>