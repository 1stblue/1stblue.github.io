<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">构建跨网络数据管道最佳实践 | 1stblue.com</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://1stblue.github.io/blog/bluepipe-with-lakehouse"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="react-admin, react-framework, internal-tool, admin-panel, ant-design, material ui, mui"><meta data-rh="true" property="og:title" content="构建跨网络数据管道最佳实践 | 1stblue.com"><meta data-rh="true" name="description" content="本文以云器 Lakehouse 为例，介绍利用bluepipe构建跨网络的数据复制最佳实践。"><meta data-rh="true" property="og:description" content="本文以云器 Lakehouse 为例，介绍利用bluepipe构建跨网络的数据复制最佳实践。"><meta data-rh="true" property="og:image" content="https://1stblue.github.io/img/blog-static/cover-bridge.jpeg"><meta data-rh="true" name="twitter:image" content="https://1stblue.github.io/img/blog-static/cover-bridge.jpeg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-06-21T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/aleafs"><meta data-rh="true" property="article:tag" content="lakehouse,network,Oracle"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://1stblue.github.io/blog/bluepipe-with-lakehouse"><link data-rh="true" rel="alternate" href="https://1stblue.github.io/blog/bluepipe-with-lakehouse" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://1stblue.github.io/blog/bluepipe-with-lakehouse" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-27Z1WY952H"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-27Z1WY952H",{})</script>




<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="1stblue.com RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="1stblue.com Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="1stblue.com JSON Feed"><link rel="stylesheet" href="/assets/css/styles.6adfe103.css">
<link rel="preload" href="/assets/js/runtime~main.b25abf5d.js" as="script">
<link rel="preload" href="/assets/js/main.ddac1359.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><div class="main-wrapper min-h-[100dvh] flex flex-col bg-gray-0 transition-colors duration-150 ease-in-out"><header class="sticky top-0 z-10"><div class="absolute top-0 left-0 right-0 backdrop-blur-[6px] landing-md:backdrop-blur-[12px] z-[-1] bg-gray-0 bg-opacity-80 pointer-events-none transition-colors duration-150 ease-in-out" style="top:-20px;bottom:-80px;-webkit-mask-image:linear-gradient(to bottom, transparent 0, transparent calc(0% + 20px), black calc(0% + 20px), black calc(100% - 80px), transparent calc(100% - 80px));mask-image:linear-gradient(to bottom, transparent 0, transparent calc(0% + 20px), black calc(0% + 20px), black calc(100% - 80px), transparent calc(100% - 80px))"></div><div class="relative z-[1] p-4 landing-sm:px-8 landing-md:py-5"><div class="flex items-center justify-between max-w-[83%]"><div class="w-[130px] landing-lg:w-[200px]"><a class="flex items-center font-semibold no-underline text-gray-900" href="/"><svg width="40" height="40" viewBox="0 0 201 201" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M100.774 16.656C54.3819 16.656 16.7739 54.264 16.7739 100.656C16.7739 147.048 54.3819 184.656 100.774 184.656C147.166 184.656 184.774 147.048 184.774 100.656C184.774 54.264 147.166 16.656 100.774 16.656ZM137.93 93.266L127.584 108.041L110.498 132.442H136.082L102.962 143.204L61.5629 156.656V156.652L78.5129 132.443H78.517L95.5989 108.042H63.619L73.9689 93.267L91.0549 68.866H65.4709L98.5909 58.105L139.986 44.657L123.036 68.866H123.032L105.95 93.267H137.931L137.93 93.266Z" fill="url(#paint0_linear_22_656)"></path><defs><linearGradient id="paint0_linear_22_656" x1="16.7739" y1="100.656" x2="184.774" y2="100.656" gradientUnits="userSpaceOnUse"><stop stop-color="#19DEF8"></stop><stop offset="0.142" stop-color="#14C0F5"></stop><stop offset="0.431" stop-color="#0B8AF1"></stop><stop offset="0.681" stop-color="#0562EE"></stop><stop offset="0.879" stop-color="#0149EC"></stop><stop offset="1" stop-color="#0041EC"></stop></linearGradient></defs></svg>    Bluepipe</a></div><button type="button" class="text-gray-900 block landing-md:hidden"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none"><path fill="currentColor" d="M4 10a1 1 0 0 1 1-1h22a1 1 0 1 1 0 2H5a1 1 0 0 1-1-1ZM4 16a1 1 0 0 1 1-1h22a1 1 0 1 1 0 2H5a1 1 0 0 1-1-1ZM5 21a1 1 0 1 0 0 2h22a1 1 0 1 0 0-2H5Z"></path></svg></button><div class="hidden landing-md:flex flex-1 items-center gap-8"><div id="popover-产品" class="relative inline-flex items-center" data-headlessui-state=""><button class="inline-flex items-center text-sm leading-6 font-normal" type="button" aria-expanded="false" data-headlessui-state=""><span class="text-gray-900 transition-colors duration-150 ease-in-out inline-block hover:text-bluepipe-blue">产品</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true" class="transition duration-150 ease-out -mr-2 text-sm leading-6 text-gray-500"><path fill="currentColor" fill-rule="evenodd" d="M15.707 9.793a1 1 0 0 0-1.414 0L12 12.086 9.707 9.793a1 1 0 0 0-1.414 1.414l3 3a1 1 0 0 0 1.414 0l3-3a1 1 0 0 0 0-1.414Z" clip-rule="evenodd"></path></svg></button></div><div style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></div><a class="inline-flex items-center gap-2 text-sm leading-6 font-normal text-gray-900 transition-colors duration-150 ease-in-out no-underline hover:text-bluepipe-blue hover:text-gray-900" href="/docs">文档</a><a class="inline-flex items-center gap-2 text-sm leading-6 font-normal text-gray-900 transition-colors duration-150 ease-in-out no-underline hover:text-bluepipe-blue hover:text-gray-900" href="/blog">博客</a><a class="inline-flex items-center gap-2 text-sm leading-6 font-normal text-gray-900 transition-colors duration-150 ease-in-out no-underline hover:text-bluepipe-blue hover:text-gray-900" href="/connectors">连接器</a><a class="inline-flex items-center gap-2 text-sm leading-6 font-normal text-gray-900 transition-colors duration-150 ease-in-out no-underline hover:text-bluepipe-blue hover:text-gray-900" href="/tests">测试集</a></div><div class="hidden landing-md:flex items-center justify-end gap-4 w-[130px] landing-lg:w-[200px]"></div></div></div><div class="w-full h-0.5 translate"><div class="h-full bg-bluepipe-blue" style="width:0%"></div></div></header><div class="flex justify-center mx-auto max-w-screen-blog-max w-full"><div class="bluepipe-prose flex-1 min-w-0 xl:px-8"><article class="py-10 px-4 sm:px-0 blog-sm:py-12 blog-md:py-16 w-full mx-auto max-w-[512px] blog-sm:max-w-screen-blog-sm blog-lg:max-w-screen-content-2xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="image" content="https://1stblue.github.io/img/blog-static/cover-bridge.jpeg"><div class="text-sm"><div class="flex justify-between sm:flex-row flex-col"><div class="flex justify-center items-center gap-2"><a class="!text-gray-500 text-sm no-underline" href="/blog">← 返回博客</a></div><div class="flex items-center gap-2 text-gray-600"><time datetime="2024-06-21T00:00:00.000Z" itemprop="datePublished">2024年6月21日</time><span class="w-[4px] h-[4px] rounded-full bg-gray-600"></span>阅读需 4 分钟<a class="cursor-pointer">下载</a></div></div></div><div class="blog-sm:p-6 bluepipe-prose-blog-content"><h1 class="text-xl md:text-4xl" itemprop="headline">构建跨网络数据管道最佳实践</h1><div id="post-content" class="markdown" itemprop="articleBody"><p>本文以<a href="https://yunqi.tech/" target="_blank" rel="noopener noreferrer nofollow">云器</a> <code>Lakehouse</code> 为例，介绍利用<code>bluepipe</code>构建跨网络的数据复制最佳实践。</p><p>如下图，客户业务系统部署在私有 IDC 中，而<code>Lakehouse</code>作为多租户湖仓服务部署在云上。数据需要从<code>Oracle</code>同步到<code>Lakehouse</code>
，我们推荐将<code>bluepipe</code>部署在客户 IDC 中，<strong>推</strong>数据到<code>Lakehouse</code>。</p><p><img loading="lazy" alt="Oracle to Lakehouse" src="/assets/images/cross-network-pipe-eddbc84234790986facb8dda2658652e.png" width="2350" height="520" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="方案优势">方案优势<a href="#方案优势" class="hash-link" aria-label="方案优势的直接链接" title="方案优势的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="开箱即用10-分钟完成配置">开箱即用，10 分钟完成配置<a href="#开箱即用10-分钟完成配置" class="hash-link" aria-label="开箱即用，10 分钟完成配置的直接链接" title="开箱即用，10 分钟完成配置的直接链接">​</a></h3><ul><li><code>bluepipe</code>几乎可以运行在任何<code>Linux</code>系统中，支持<code>x86</code>和<code>arm</code>芯片；常见的机架式服务器、笔记本电脑，甚至树莓派都可以用来部署；</li><li>极简的配置过程，默认参数即可达到最佳性能。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="全增量一体化无需运维干预">全、增量一体化，无需运维干预<a href="#全增量一体化无需运维干预" class="hash-link" aria-label="全、增量一体化，无需运维干预的直接链接" title="全、增量一体化，无需运维干预的直接链接">​</a></h3><ul><li>全量同步与增量同步深度协同，几乎无需日常运维操作；</li><li>高效的数据比对与热修复技术，始终保证数据一致；</li><li>高度鲁棒的<code>Schema Evolution</code>。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="推数据而不是暴露端口">推数据，而不是暴露端口<a href="#推数据而不是暴露端口" class="hash-link" aria-label="推数据，而不是暴露端口的直接链接" title="推数据，而不是暴露端口的直接链接">​</a></h3><ul><li><code>bluepipe</code>与您的数据库一起部署在您的内网，无需对外暴露端口；</li><li>弹性<code>buffer size</code>技术，在<code>吞吐(Throughput)</code>和<code>延迟(latency)</code>之间自动平衡。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="oracle链路的独特优势"><code>Oracle</code>链路的独特优势<a href="#oracle链路的独特优势" class="hash-link" aria-label="oracle链路的独特优势的直接链接" title="oracle链路的独特优势的直接链接">​</a></h2><p><code>bluepipe</code>基于<code>Oracle LogMiner</code>实现对变更数据的捕捉。与此同时，在以下几个方面做了深度优化：</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="对ddl行为的深度兼容">对<code>DDL</code>行为的深度兼容<a href="#对ddl行为的深度兼容" class="hash-link" aria-label="对ddl行为的深度兼容的直接链接" title="对ddl行为的深度兼容的直接链接">​</a></h3><p>在<code>LogMiner</code>默认策略下，当发生<code>DDL</code>行为后，相关表上后续的<code>DML</code>操作均无法正确解析，从而导致无法正确捕捉到变更。</p><p><code>bluepipe</code>维护了字典文件的自动构建策略，保证表结构变更后仍然能捕捉到正确的增量数据。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="大事务优化">大事务优化<a href="#大事务优化" class="hash-link" aria-label="大事务优化的直接链接" title="大事务优化的直接链接">​</a></h3><p><code>Oracle Redo Log</code>中记录了完整的事务(<code>Transaction</code>)过程，而业务上通常仅希望拿到<code>commit</code>
之后的数据，因此，需要在传输过程中使用<code>buffer</code>来暂存尚未<code>commit</code>的变更记录。</p><p><code>bluepipe</code>基于独特的内存管理技术，单节点上也能轻松应对千万量级的大事务。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="全面支持名称超过-30-字符的表">全面支持名称超过 30 字符的表<a href="#全面支持名称超过-30-字符的表" class="hash-link" aria-label="全面支持名称超过 30 字符的表的直接链接" title="全面支持名称超过 30 字符的表的直接链接">​</a></h3><p><code>Oracle 12.2</code>版本之后，对表名、字段名的最大长度支持到了 128 字节。
但因为种种原因，<code>LogMiner</code>对于无<code>OGG LICENSE</code>的实例，至今仍不支持对包含长名称的表的 DML
解析，详情参考<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/sutil/oracle-logminer-utility.html" target="_blank" rel="noopener noreferrer nofollow">官方文档</a>。</p><p><code>bluepipe</code>基于高效的流批融合技术，全面支持了此种情况下的增量数据捕捉与投递。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="适配支持rac架构">适配支持<code>RAC</code>架构<a href="#适配支持rac架构" class="hash-link" aria-label="适配支持rac架构的直接链接" title="适配支持rac架构的直接链接">​</a></h3></div></div></article><div class="mx-auto w-full py-10 blog-sm:py-12 blog-md:py-16 max-w-[512px] blog-sm:max-w-screen-blog-sm blog-lg:max-w-screen-content-2xl"><div class="blog-sm:px-6 w-full px-4"><h2 class="m-0 mb-4 p-0 pl-4 text-2xl font-semibold text-gray-900">Related Articles</h2><div class="flex flex-col"><div class="flex flex-col p-5 mb-5 rounded-md bg-gray-50"><a rel="dofollow" class="font-bold text-gray-800 no-underline hover:text-gray-800 hover:no-underline mb-2" href="/blog/oracle-split-read">Oracle大表的并行读取</a><p class="font-sm text-gray-700">测试环境</p><div id="post-info" class="flex items-center gap-2 text-sm text-gray-600"><time datetime="2023-10-11T00:00:00.000Z" itemprop="datePublished">2023年10月11日</time></div></div></div></div></div></div><div class="w-[280px] hidden blog-md:block flex-shrink-0"><div class="hidden blog-md:block w-full sticky right-0 top-[80px] max-w-[280px] overflow-auto h-[calc(100vh-80px)] px-3 blog-md:py-16 border-l border-l-gray-100"><div class="flex flex-wrap gap-2 pb-6 pl-1"><a class="text-xs bg-gray-100 text-gray-600 rounded py-1 px-2 no-underline hover:no-underline whitespace-nowrap" href="/blog/tags/lakehouse">lakehouse</a><a class="text-xs bg-gray-100 text-gray-600 rounded py-1 px-2 no-underline hover:no-underline whitespace-nowrap" href="/blog/tags/network">network</a><a class="text-xs bg-gray-100 text-gray-600 rounded py-1 px-2 no-underline hover:no-underline whitespace-nowrap" href="/blog/tags/oracle">Oracle</a></div><ul class="list-none m-0 p-0"><li><a href="#方案优势" class="bluepipe-toc-item pl-3 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">方案优势</a></li><li><a href="#开箱即用10-分钟完成配置" class="bluepipe-toc-item pl-7 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">开箱即用，10 分钟完成配置</a></li><li><a href="#全增量一体化无需运维干预" class="bluepipe-toc-item pl-7 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">全、增量一体化，无需运维干预</a></li><li><a href="#推数据而不是暴露端口" class="bluepipe-toc-item pl-7 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">推数据，而不是暴露端口</a></li><li><a href="#oracle链路的独特优势" class="bluepipe-toc-item pl-3 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline"><code>Oracle</code>链路的独特优势</a></li><li><a href="#对ddl行为的深度兼容" class="bluepipe-toc-item pl-7 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">对<code>DDL</code>行为的深度兼容</a></li><li><a href="#大事务优化" class="bluepipe-toc-item pl-7 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">大事务优化</a></li><li><a href="#全面支持名称超过-30-字符的表" class="bluepipe-toc-item pl-7 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">全面支持名称超过 30 字符的表</a></li><li><a href="#适配支持rac架构" class="bluepipe-toc-item pl-7 py-2 pr-3 hover:text-gray-900 text-gray-500 rounded-lg transition-colors duration-200 ease-in-out block text-sm leading-6 no-underline hover:no-underline">适配支持<code>RAC</code>架构</a></li></ul></div></div></div><footer class="w-full"><div class="border-t border-t-solid border-t-gray-100"><div class="grid grid-cols-1 max-w-screen-landing-md landing-lg:max-w-screen-landing-lg mx-auto"><div class="px-4 landing-sm:px-8 landing-lg:px-12 py-6 landing-lg:pt-8 landing-lg:pb-12 flex flex-row flex-wrap items-start justify-start gap-6"><div class="hidden landing-lg:flex max-w-[282px] w-full"><div class="py-6 landing-lg:py-0 flex flex-col gap-4 landing-lg:max-w-[224px]"><div class="font-semibold text-sm leading-6 text-gray-900">关于萃蓝</div><div class="font-normal text-sm leading-5 text-gray-600"></div></div></div><div class="flex flex-col gap-4 min-w-[152px]"><div class="text-sm leading-6 font-semibold text-gray-900">用户协议</div><div class="flex flex-col gap-2"><a href="/user-agreement" class="text-sm leading-5 hover:no-underline text-gray-600 hover:text-gray-800">用户协议</a></div></div><div class="flex flex-col gap-4 min-w-[152px]"><div class="text-sm leading-6 font-semibold text-gray-900">隐私政策</div><div class="flex flex-col gap-2"><a href="/privacy-policy" class="text-sm leading-5 hover:no-underline text-gray-600 hover:text-gray-800">隐私协议</a></div></div><div class="flex flex-col gap-4 min-w-[152px]"><div class="text-sm leading-6 font-semibold text-gray-900">网站备案</div><div class="flex flex-col gap-2"></div></div></div><div class="px-4 landing-sm:px-8 grid grid-cols-1 landing-sm:grid-cols-2 landing-sm:gap-8 landing-lg:hidden"><div class="py-6 landing-lg:py-0 flex flex-col gap-4 landing-lg:max-w-[224px]"><div class="font-semibold text-sm leading-6 text-gray-900">关于萃蓝</div><div class="font-normal text-sm leading-5 text-gray-600"></div></div></div></div></div><div class="border-t border-t-solid border-t-gray-100 bg-gray-50"><div class="py-6 landing-sm:py-8 landing-lg:py-6 px-4 landing-sm:px-8 landing-lg:px-12 grid grid-cols-1 landing-md:grid-cols-2 gap-8 max-w-screen-landing-md landing-lg:max-w-screen-landing-lg mx-auto"><div class="flex flex-col landing-sm:flex-row gap-4 items-start justify-start"></div><div class="text-left landing-md:text-right text-sm pr-6 landing-sm:pr-0 leading-5 text-gray-900 font-normal">© 2024, 1stblue.com</div></div></div></footer></div></div>
<script src="/assets/js/runtime~main.b25abf5d.js"></script>
<script src="/assets/js/main.ddac1359.js"></script>
</body>
</html>